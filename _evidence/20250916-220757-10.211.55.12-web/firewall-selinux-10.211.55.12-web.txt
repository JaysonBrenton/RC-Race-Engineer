+ echo '===== CAPTURE START: 20250916-220757 @ 10.211.55.12-web ====='
===== CAPTURE START: 20250916-220757 @ 10.211.55.12-web =====
+ echo '# uname -a'
# uname -a
+ uname -a
Linux rcraceengineer 5.14.0-612.el9.aarch64 #1 SMP PREEMPT_DYNAMIC Sat Aug 30 16:28:51 UTC 2025 aarch64 aarch64 aarch64 GNU/Linux
+ echo

+ echo '===== PACKAGES ====='
===== PACKAGES =====
+ rpm -q firewalld
firewalld-1.3.4-15.el9.noarch
+ rpm -q policycoreutils policycoreutils-python-utils
policycoreutils-3.6-3.el9.aarch64
policycoreutils-python-utils-3.6-3.el9.noarch
+ rpm -q setools-console setroubleshoot-server
package setools-console is not installed
setroubleshoot-server-3.3.35-2.el9.aarch64
+ true
+ echo

+ echo '===== FIREWALLD: SERVICE STATE ====='
===== FIREWALLD: SERVICE STATE =====
+ systemctl is-enabled firewalld
enabled
+ systemctl is-active firewalld
active
+ systemctl status firewalld --no-pager --full
● firewalld.service - firewalld - dynamic firewall daemon
     Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-09-16 14:49:20 AEST; 7h ago
       Docs: man:firewalld(1)
   Main PID: 838 (firewalld)
      Tasks: 4 (limit: 34624)
     Memory: 48.9M (peak: 67.7M)
        CPU: 1.745s
     CGroup: /system.slice/firewalld.service
             └─838 /usr/bin/python3 -s /usr/sbin/firewalld --nofork --nopid

Sep 16 14:49:20 rcraceengineer systemd[1]: Starting firewalld - dynamic firewall daemon...
Sep 16 14:49:20 rcraceengineer systemd[1]: Started firewalld - dynamic firewall daemon.
Sep 16 19:06:45 rcraceengineer firewalld[838]: WARNING: ALREADY_ENABLED: 3000:tcp
Sep 16 19:52:27 rcraceengineer systemd[1]: Started firewalld - dynamic firewall daemon.
Sep 16 19:52:27 rcraceengineer firewalld[838]: WARNING: ALREADY_ENABLED: 3000:tcp
+ echo

+ echo '===== FIREWALLD: CONFIG ====='
===== FIREWALLD: CONFIG =====
+ firewall-cmd --state
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --get-active-zones
public
  interfaces: enp0s5
+ firewall-cmd --zone=public --list-all
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --list-all
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --list-ports
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --list-services
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --list-rich-rules
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ echo

+ echo '===== FIREWALLD (PERMANENT): ALL ZONES ====='
===== FIREWALLD (PERMANENT): ALL ZONES =====
+ firewall-cmd --permanent --get-zones
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ firewall-cmd --permanent --get-active-zones
usage: 'firewall-cmd --help' for usage information or see firewall-cmd(1) man page
Can't use stand-alone options with other options.
+ true
+ firewall-cmd --permanent --list-all-zones
Authorization failed.
    Make sure polkit agent is running or run the application as superuser.
+ true
+ echo

+ echo '===== NFT / IPTABLES BACKENDS ====='
===== NFT / IPTABLES BACKENDS =====
+ nft list ruleset
Operation not permitted (you must be root)
netlink: Error: cache initialization failed: Operation not permitted
+ true
+ iptables -S
iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
+ true
+ ip6tables -S
ip6tables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
+ true
+ echo

+ echo '===== SELINUX: STATUS ====='
===== SELINUX: STATUS =====
+ getenforce
Enforcing
+ sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual (secure)
Max kernel policy version:      33
+ echo

+ echo '===== SELINUX: BOOLEANS OF INTEREST ====='
===== SELINUX: BOOLEANS OF INTEREST =====
+ getsebool -a
+ grep -E 'httpd_can_network_connect(_db)?|nis_enabled'
httpd_can_network_connect --> off
httpd_can_network_connect_cobbler --> off
httpd_can_network_connect_db --> off
nis_enabled --> off
+ echo

+ echo '===== SELINUX: PORT TYPES ====='
===== SELINUX: PORT TYPES =====
+ command -v semanage
+ semanage port -l
+ egrep -i 'http_port_t|node_t|postgresql_port_t|ephemeral_port_t'
ValueError: SELinux policy is not managed or store cannot be accessed.
+ true
+ echo

+ echo '===== SELINUX: RECENT AVC DENIALS ====='
===== SELINUX: RECENT AVC DENIALS =====
+ command -v ausearch
+ ausearch -m AVC,USER_AVC -ts yesterday
Error opening config file (Permission denied)
NOTE - using built-in end_of_event_timeout: 2
NOTE - using built-in logs: /var/log/audit/audit.log
Error opening /var/log/audit/audit.log (Permission denied)
+ true
+ echo

+ echo '===== OPEN PORTS (expected: 3000, 1337, 5432) ====='
===== OPEN PORTS (expected: 3000, 1337, 5432) =====
+ ss -tulpn
+ egrep ':(3000|1337|5432)\\b'
+ true
+ echo

+ echo '===== PROCESSES (node/strapi/postgres) ====='
===== PROCESSES (node/strapi/postgres) =====
+ ps -eo pid,ppid,user,cmd
+ egrep -i 'node|strapi|postgres'
+ egrep -v egrep
    998       1 postgres /usr/bin/postmaster -D /var/lib/pgsql/data
   1043     998 postgres postgres: logger 
   1072     998 postgres postgres: checkpointer 
   1073     998 postgres postgres: background writer 
   1074     998 postgres postgres: walwriter 
   1075     998 postgres postgres: autovacuum launcher 
   1076     998 postgres postgres: stats collector 
   1077     998 postgres postgres: logical replication launcher 
 260838  260664 jayson   grep -E -i node|strapi|postgres
+ echo

+ echo '===== QUICK HTTP PROBES ====='
===== QUICK HTTP PROBES =====
+ curl -I --max-time 3 http://127.0.0.1:3000/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0 13856    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
HTTP/1.1 200 OK
Vary: rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch, Accept-Encoding
x-nextjs-cache: HIT
x-nextjs-prerender: 1
x-nextjs-prerender: 1
x-nextjs-stale-time: 300
X-Powered-By: Next.js
Cache-Control: s-maxage=31536000
ETag: "g6y4a47exfaos"
Content-Type: text/html; charset=utf-8
Content-Length: 13856
Date: Tue, 16 Sep 2025 12:08:00 GMT
Connection: keep-alive
Keep-Alive: timeout=5

+ curl -I --max-time 3 http://127.0.0.1:1337/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
curl: (7) Failed to connect to 127.0.0.1 port 1337: Connection refused
+ true
+ echo

+ echo '===== JOURNAL RECENT FIREWALL/SELINUX MESSAGES ====='
===== JOURNAL RECENT FIREWALL/SELINUX MESSAGES =====
+ journalctl -q -b -n 200
+ egrep -i 'firewalld|selinux|avc|denied'
+ true
+ echo

+ echo '===== CAPTURE END: 20250916-220757 @ 10.211.55.12-web ====='
===== CAPTURE END: 20250916-220757 @ 10.211.55.12-web =====
+ echo 'Output saved to: /home/jayson/Development/RCRaceEngineer/_evidence/20250916-220757-10.211.55.12-web/firewall-selinux-10.211.55.12-web.txt'
Output saved to: /home/jayson/Development/RCRaceEngineer/_evidence/20250916-220757-10.211.55.12-web/firewall-selinux-10.211.55.12-web.txt
